fn get_folder_path (folder_id : & GUID) -> Result < OsString , AppDirsError > { { let mut raw_path : PWSTR = ptr :: null_mut () ; let result = SHGetKnownFolderPath (folder_id , 0 , ptr :: null_mut () , & mut raw_path) ; if result < 0 { return Err (AppDirsError :: NotSupported) ; } let _cleanup = SafePwstr (raw_path) ; let mut length = 0 ; for i in 0 .. { if * raw_path . offset (i) == 0 { length = i as usize ; break ; } } let wpath : & [u16] = slice :: from_raw_parts (raw_path , length) ; let path : OsString = OsStringExt :: from_wide (wpath) ; Ok (path) } }